<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cryptography | Asim Osman</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        code, .mono { font-family: 'Fira Code', monospace; }
        .demo-box {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-900">
    <nav class="fixed top-0 w-full bg-white/80 backdrop-blur-md z-50 border-b border-gray-100">
        <div class="max-w-4xl mx-auto px-6 py-4 flex justify-between items-center">
            <a href="/" class="text-xl font-bold gradient-text">AO</a>
            <a href="/journey.html" class="text-gray-600 hover:text-gray-900">‚Üê Back to Journey</a>
        </div>
    </nav>

    <main class="pt-24 pb-16">
        <div class="max-w-4xl mx-auto px-6">
            <!-- Header -->
            <div class="mb-8">
                <span class="text-5xl">üîê</span>
                <h1 class="text-4xl font-bold mt-4">Cryptography Implementations</h1>
                <p class="text-gray-500 mt-2 text-lg">2024 ‚Äî Security Fundamentals from Scratch</p>
            </div>

            <!-- About -->
            <div class="prose max-w-none mb-10">
                <h2 class="text-xl font-semibold mb-4">About</h2>
                <p class="text-gray-600 text-lg leading-relaxed">
                    Pure Python implementations of classic cryptographic algorithms ‚Äî no libraries, just math. 
                    Built to deeply understand how encryption, hashing, and security primitives work at the bit level.
                    <strong>Try them live below!</strong>
                </p>
            </div>

            <!-- Live Demos Section -->
            <div class="mb-10">
                <h2 class="text-xl font-semibold mb-4">üéÆ Live Demos</h2>
                
                <!-- Demo 1: Vigen√®re -->
                <div class="demo-box p-6 rounded-xl text-white mb-4">
                    <h3 class="text-lg font-semibold mb-3">üî§ Vigen√®re Cipher</h3>
                    <p class="text-gray-300 text-sm mb-4">Classical polyalphabetic substitution cipher</p>
                    
                    <div class="grid md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Message</label>
                            <input type="text" id="vigenere-msg" value="helloworld" 
                                   class="w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white mono focus:outline-none focus:border-indigo-500">
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Key</label>
                            <input type="text" id="vigenere-key" value="secret" 
                                   class="w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white mono focus:outline-none focus:border-indigo-500">
                        </div>
                    </div>
                    
                    <div class="bg-gray-800/50 p-4 rounded-lg">
                        <p class="text-sm text-gray-400 mb-1">Encrypted:</p>
                        <p id="vigenere-output" class="text-xl mono text-green-400 font-bold">ZINCSPGVNU</p>
                    </div>
                    
                    <details class="mt-3">
                        <summary class="text-sm text-gray-400 cursor-pointer hover:text-gray-300">How it works</summary>
                        <p class="text-sm text-gray-400 mt-2">C[i] = (M[i] + K[i]) mod 26 ‚Äî each letter shifts by the key letter's position</p>
                    </details>
                </div>

                <!-- Demo 2: SHA-512 -->
                <div class="demo-box p-6 rounded-xl text-white mb-4">
                    <h3 class="text-lg font-semibold mb-3">#Ô∏è‚É£ SHA-512 Hash</h3>
                    <p class="text-gray-300 text-sm mb-4">Cryptographic hash function (512-bit output)</p>
                    
                    <div class="mb-4">
                        <label class="block text-sm text-gray-400 mb-1">Input Text</label>
                        <input type="text" id="sha-input" value="Hello World" 
                               class="w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white mono focus:outline-none focus:border-indigo-500">
                    </div>
                    
                    <div class="bg-gray-800/50 p-4 rounded-lg">
                        <p class="text-sm text-gray-400 mb-1">SHA-512 Hash:</p>
                        <p id="sha-output" class="text-xs mono text-green-400 font-bold break-all">2c74fd17edafd80e8447b0d46741ee243b7eb74dd2149a0ab1b9246fb30382f27e853d8585719e0e67cbda0daa8f51671064615d645ae27acb15bfb1447f459b</p>
                    </div>
                    
                    <details class="mt-3">
                        <summary class="text-sm text-gray-400 cursor-pointer hover:text-gray-300">How it works</summary>
                        <p class="text-sm text-gray-400 mt-2">80 rounds of compression using œÉ, Œ£, Ch, Maj operations on 64-bit words. One-way function ‚Äî can't reverse!</p>
                    </details>
                </div>

                <!-- Demo 3: AES-128 -->
                <div class="demo-box p-6 rounded-xl text-white">
                    <h3 class="text-lg font-semibold mb-3">üîí AES-128 Encryption</h3>
                    <p class="text-gray-300 text-sm mb-4">Industry-standard symmetric cipher (enter hex values)</p>
                    
                    <div class="grid md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Plaintext (32 hex chars)</label>
                            <input type="text" id="aes-plaintext" value="54776F204F6E65204E696E652054776F" 
                                   class="w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white mono text-xs focus:outline-none focus:border-indigo-500">
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Key (32 hex chars)</label>
                            <input type="text" id="aes-key" value="5468617473206D79204B756E67204675" 
                                   class="w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white mono text-xs focus:outline-none focus:border-indigo-500">
                        </div>
                    </div>
                    
                    <div class="bg-gray-800/50 p-4 rounded-lg">
                        <p class="text-sm text-gray-400 mb-1">Ciphertext:</p>
                        <p id="aes-output" class="text-lg mono text-green-400 font-bold">29c3505f571420f6402299b31a02d73a</p>
                    </div>
                    
                    <details class="mt-3">
                        <summary class="text-sm text-gray-400 cursor-pointer hover:text-gray-300">How it works</summary>
                        <p class="text-sm text-gray-400 mt-2">10 rounds of SubBytes (S-box), ShiftRows, MixColumns (GF(2‚Å∏) math), and AddRoundKey with key expansion</p>
                    </details>
                </div>
            </div>

            <!-- Algorithm Cards -->
            <div class="mb-10">
                <h2 class="text-xl font-semibold mb-4">Implementation Details</h2>
                <div class="space-y-4">
                    
                    <div class="bg-white p-5 rounded-xl shadow-sm">
                        <h3 class="font-semibold mb-2">Vigen√®re Cipher</h3>
                        <p class="text-gray-600 text-sm mb-2">Polyalphabetic substitution where each letter is shifted by the corresponding key letter. Key repeats to match message length.</p>
                        <div class="flex gap-2 flex-wrap">
                            <span class="text-xs bg-indigo-100 text-indigo-700 px-2 py-1 rounded">Symmetric</span>
                            <span class="text-xs bg-indigo-100 text-indigo-700 px-2 py-1 rounded">Classical</span>
                        </div>
                    </div>
                    
                    <div class="bg-white p-5 rounded-xl shadow-sm">
                        <h3 class="font-semibold mb-2">AES-128</h3>
                        <p class="text-gray-600 text-sm mb-2">Block cipher with 128-bit key. Implements S-box substitution, row shifting, column mixing in GF(2‚Å∏), and round key addition across 10 rounds.</p>
                        <div class="flex gap-2 flex-wrap">
                            <span class="text-xs bg-indigo-100 text-indigo-700 px-2 py-1 rounded">10 Rounds</span>
                            <span class="text-xs bg-indigo-100 text-indigo-700 px-2 py-1 rounded">S-Box</span>
                            <span class="text-xs bg-indigo-100 text-indigo-700 px-2 py-1 rounded">GF(2‚Å∏)</span>
                            <span class="text-xs bg-indigo-100 text-indigo-700 px-2 py-1 rounded">Key Expansion</span>
                        </div>
                    </div>
                    
                    <div class="bg-white p-5 rounded-xl shadow-sm">
                        <h3 class="font-semibold mb-2">SHA-512</h3>
                        <p class="text-gray-600 text-sm mb-2">Cryptographic hash with 512-bit output. Uses message padding, 80-round compression with bitwise œÉ, Œ£, Ch, Maj operations on 64-bit words.</p>
                        <div class="flex gap-2 flex-wrap">
                            <span class="text-xs bg-indigo-100 text-indigo-700 px-2 py-1 rounded">80 Rounds</span>
                            <span class="text-xs bg-indigo-100 text-indigo-700 px-2 py-1 rounded">512-bit</span>
                            <span class="text-xs bg-indigo-100 text-indigo-700 px-2 py-1 rounded">One-Way</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- What I Learned -->
            <div class="mb-10">
                <h2 class="text-xl font-semibold mb-4">What I Learned</h2>
                <div class="bg-gradient-to-r from-indigo-50 to-purple-50 p-6 rounded-xl">
                    <ul class="space-y-2 text-gray-700">
                        <li>‚Ä¢ Bitwise operations and their role in security (XOR, rotations, shifts)</li>
                        <li>‚Ä¢ Galois Field arithmetic (GF(2‚Å∏)) for AES MixColumns</li>
                        <li>‚Ä¢ Why padding schemes matter (length extension attacks)</li>
                        <li>‚Ä¢ The difference between encryption (reversible) and hashing (one-way)</li>
                        <li>‚Ä¢ How modern ciphers achieve confusion and diffusion</li>
                    </ul>
                </div>
            </div>

            <!-- Links -->
            <div class="flex gap-4">
                <a href="https://github.com/Asimawad/Cryptography-and-Security-Technology" target="_blank" 
                   class="inline-flex items-center gap-2 px-5 py-2.5 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/></svg>
                    View Source Code
                </a>
            </div>

            <!-- Back -->
            <div class="mt-12 pt-8 border-t">
                <a href="/journey.html#chapter-1" class="text-indigo-600 hover:text-indigo-700 font-medium">‚Üê Back to Journey</a>
            </div>
        </div>
    </main>

    <script>
        // ==================== VIGEN√àRE CIPHER ====================
        function encryptVigenere() {
            const msg = document.getElementById('vigenere-msg').value.toLowerCase().replace(/[^a-z]/g, '');
            const key = document.getElementById('vigenere-key').value.toLowerCase().replace(/[^a-z]/g, '');
            
            if (!msg || !key) {
                document.getElementById('vigenere-output').textContent = 'Enter message and key';
                return;
            }
            
            let fullKey = '';
            for (let i = 0; i < msg.length; i++) fullKey += key[i % key.length];
            
            let ciphertext = '';
            for (let i = 0; i < msg.length; i++) {
                const encChar = (msg.charCodeAt(i) - 97 + fullKey.charCodeAt(i) - 97) % 26;
                ciphertext += String.fromCharCode(encChar + 65);
            }
            
            document.getElementById('vigenere-output').textContent = ciphertext;
        }

        // ==================== SHA-512 (using Web Crypto API) ====================
        async function hashSHA512() {
            const input = document.getElementById('sha-input').value;
            const encoder = new TextEncoder();
            const data = encoder.encode(input);
            const hashBuffer = await crypto.subtle.digest('SHA-512', data);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
            document.getElementById('sha-output').textContent = hashHex;
        }

        // ==================== AES-128 (Pure JS Implementation) ====================
        const Sbox = [
            0x63,0x7c,0x77,0x7b,0xf2,0x6b,0x6f,0xc5,0x30,0x01,0x67,0x2b,0xfe,0xd7,0xab,0x76,
            0xca,0x82,0xc9,0x7d,0xfa,0x59,0x47,0xf0,0xad,0xd4,0xa2,0xaf,0x9c,0xa4,0x72,0xc0,
            0xb7,0xfd,0x93,0x26,0x36,0x3f,0xf7,0xcc,0x34,0xa5,0xe5,0xf1,0x71,0xd8,0x31,0x15,
            0x04,0xc7,0x23,0xc3,0x18,0x96,0x05,0x9a,0x07,0x12,0x80,0xe2,0xeb,0x27,0xb2,0x75,
            0x09,0x83,0x2c,0x1a,0x1b,0x6e,0x5a,0xa0,0x52,0x3b,0xd6,0xb3,0x29,0xe3,0x2f,0x84,
            0x53,0xd1,0x00,0xed,0x20,0xfc,0xb1,0x5b,0x6a,0xcb,0xbe,0x39,0x4a,0x4c,0x58,0xcf,
            0xd0,0xef,0xaa,0xfb,0x43,0x4d,0x33,0x85,0x45,0xf9,0x02,0x7f,0x50,0x3c,0x9f,0xa8,
            0x51,0xa3,0x40,0x8f,0x92,0x9d,0x38,0xf5,0xbc,0xb6,0xda,0x21,0x10,0xff,0xf3,0xd2,
            0xcd,0x0c,0x13,0xec,0x5f,0x97,0x44,0x17,0xc4,0xa7,0x7e,0x3d,0x64,0x5d,0x19,0x73,
            0x60,0x81,0x4f,0xdc,0x22,0x2a,0x90,0x88,0x46,0xee,0xb8,0x14,0xde,0x5e,0x0b,0xdb,
            0xe0,0x32,0x3a,0x0a,0x49,0x06,0x24,0x5c,0xc2,0xd3,0xac,0x62,0x91,0x95,0xe4,0x79,
            0xe7,0xc8,0x37,0x6d,0x8d,0xd5,0x4e,0xa9,0x6c,0x56,0xf4,0xea,0x65,0x7a,0xae,0x08,
            0xba,0x78,0x25,0x2e,0x1c,0xa6,0xb4,0xc6,0xe8,0xdd,0x74,0x1f,0x4b,0xbd,0x8b,0x8a,
            0x70,0x3e,0xb5,0x66,0x48,0x03,0xf6,0x0e,0x61,0x35,0x57,0xb9,0x86,0xc1,0x1d,0x9e,
            0xe1,0xf8,0x98,0x11,0x69,0xd9,0x8e,0x94,0x9b,0x1e,0x87,0xe9,0xce,0x55,0x28,0xdf,
            0x8c,0xa1,0x89,0x0d,0xbf,0xe6,0x42,0x68,0x41,0x99,0x2d,0x0f,0xb0,0x54,0xbb,0x16
        ];
        const Rcon = [0x01,0x02,0x04,0x08,0x10,0x20,0x40,0x80,0x1b,0x36];

        function hexToState(hex) {
            const state = [[],[],[],[]];
            for (let i = 0; i < 16; i++) {
                state[i % 4][Math.floor(i / 4)] = parseInt(hex.substr(i * 2, 2), 16);
            }
            return state;
        }

        function stateToHex(state) {
            let hex = '';
            for (let j = 0; j < 4; j++) {
                for (let i = 0; i < 4; i++) {
                    hex += state[i][j].toString(16).padStart(2, '0');
                }
            }
            return hex;
        }

        function subBytes(state) {
            for (let i = 0; i < 4; i++)
                for (let j = 0; j < 4; j++)
                    state[i][j] = Sbox[state[i][j]];
        }

        function shiftRows(state) {
            for (let i = 1; i < 4; i++) {
                state[i] = state[i].slice(i).concat(state[i].slice(0, i));
            }
        }

        function gmul(a, b) {
            let p = 0;
            for (let i = 0; i < 8; i++) {
                if (b & 1) p ^= a;
                const hi = a & 0x80;
                a = (a << 1) & 0xff;
                if (hi) a ^= 0x1b;
                b >>= 1;
            }
            return p;
        }

        function mixColumns(state) {
            for (let j = 0; j < 4; j++) {
                const a = state.map(row => row[j]);
                state[0][j] = gmul(2,a[0]) ^ gmul(3,a[1]) ^ a[2] ^ a[3];
                state[1][j] = a[0] ^ gmul(2,a[1]) ^ gmul(3,a[2]) ^ a[3];
                state[2][j] = a[0] ^ a[1] ^ gmul(2,a[2]) ^ gmul(3,a[3]);
                state[3][j] = gmul(3,a[0]) ^ a[1] ^ a[2] ^ gmul(2,a[3]);
            }
        }

        function addRoundKey(state, key) {
            for (let i = 0; i < 4; i++)
                for (let j = 0; j < 4; j++)
                    state[i][j] ^= key[i][j];
        }

        function expandKey(key, round) {
            const temp = [key[0][3], key[1][3], key[2][3], key[3][3]];
            // RotWord
            temp.push(temp.shift());
            // SubWord
            for (let i = 0; i < 4; i++) temp[i] = Sbox[temp[i]];
            // Rcon
            temp[0] ^= Rcon[round];
            
            for (let j = 0; j < 4; j++) {
                for (let i = 0; i < 4; i++) {
                    key[i][j] ^= temp[i];
                }
                temp[0] = key[0][j]; temp[1] = key[1][j]; temp[2] = key[2][j]; temp[3] = key[3][j];
            }
        }

        function encryptAES() {
            let plaintext = document.getElementById('aes-plaintext').value.replace(/\s/g, '');
            let keyHex = document.getElementById('aes-key').value.replace(/\s/g, '');
            
            if (plaintext.length !== 32 || keyHex.length !== 32) {
                document.getElementById('aes-output').textContent = 'Need 32 hex chars each';
                return;
            }
            
            const state = hexToState(plaintext);
            const key = hexToState(keyHex);
            
            addRoundKey(state, key);
            
            for (let round = 0; round < 10; round++) {
                subBytes(state);
                shiftRows(state);
                if (round < 9) mixColumns(state);
                expandKey(key, round);
                addRoundKey(state, key);
            }
            
            document.getElementById('aes-output').textContent = stateToHex(state);
        }

        // Event listeners
        document.getElementById('vigenere-msg').addEventListener('input', encryptVigenere);
        document.getElementById('vigenere-key').addEventListener('input', encryptVigenere);
        document.getElementById('sha-input').addEventListener('input', hashSHA512);
        document.getElementById('aes-plaintext').addEventListener('input', encryptAES);
        document.getElementById('aes-key').addEventListener('input', encryptAES);
        
        // Initialize
        hashSHA512();
    </script>
</body>
</html>
